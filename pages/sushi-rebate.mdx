# SushiSwap Rewards and Rebates

## Rebate Calculations

_Note_: naive implementation, expect changes

bundleCost = mev bribe + bundleTxs[1,2,...]

gasAllowance = mev bribe - bundleTxs[1,2,...]

BundleTransactionGas[1,2,...] = Individual Gas Cost

BundleId = The Block Number (or hash?) in which the bundle was included

max_gasRebate = (BundleId(BundleTransactionGas[1,2,...]))

```json
{
  "confidence": 80,
  "price": 150,
  "maxPriorityFeePerGas": 1.75,
  "maxFeePerGas": 100
}
```

## Rebate Mechanism

1. Eligible transactions are rebated based on the 80th confidence interval for
   gas estimation pricing.

2. This is porportionally distributed based on transactional weight. _Note: a
   naive formula would consider pairings, then slippage tolernance and finally
   transactional amount_

3. The amount of compensation is the remainder less fees to miners and network
   operational transactional costs.

4. Compensation payouts occur no later than a half hour

## Glossary and Definitions

**Atomic arbitrage profit (aarb)**: is defined as the gain of two atomically
executed arbitrage trades $TA$ and $TB$ on exchange $A$ and $B$.

**Non-atomic arbitrage profit (naarb)**: is defined as the arbitrage gain, if
$TA$ executes first, and $TB$â€™s execution follows after $i$ intermediary
transactions.

**Holding value ($Hv$)**: is defined as the change in the averaged price of the
given asset pair on the two exchanges, which represents the asset value change
during the non-atomic execution period.

**Borrowing Capacity ($Bc$)**: Refers to the total value that a borrower is
allowed to request from a lending pool, given its collateral amount. For each
collateral asset ğ‘– of a borrower, its borrowing capacity is defined in
Equation 3.

$$ Bc =âˆ‘ï¸ ğ‘‰ ğ‘ğ‘™ğ‘¢ğ‘’ ğ‘œğ‘“ ğ¶ğ‘œğ‘™ğ‘™ğ‘ğ‘¡ğ‘’ğ‘Ÿal Ã— LTğ‘– $$

**Health Factor ($Hhf$)**: The health factor measures the collateralization
status of a position, defined as the ratio of the borrowing capacity over the
outstanding debts (cf. Equation 4).

$$ Hhf = BC / âˆ‘ï¸ ğ‘‰ğ‘ğ‘™ğ‘¢ğ‘’ ğ‘œğ‘“ ğ·ğ‘’ğ‘ğ‘¡t $$

**MVI**: Mininumal Profitable Viable Input

**Unexpected Price Slippage **\((P- E [P]):\) is the difference between \(P\)
and \(E [P]\).

**Unexpected Slippage Rate** \(\left(\frac{P- E [P]}{ E [P]}\right):\) is
\(\quad\) the unexpected slippage over the expected price.

**Expected Execution Price**: $E [P]$ When a liquidity taker issues a trade on
$X / Y,$ the taker wishes to execute the trade with the expected execution price
$E [P]$ (based on the AMM algorithm and $X / Y$ state), given the expected
slippage.

**Execution Price**: $P$ During the time difference between a liquidity taker
issuing a transaction, and the transaction being executed (e.g. mined in a
block), the state of the AMM market $X / Y$ may change. This state change may
induce unexpected slippage resulting in an execution price $P \neq E [P]$.

**Unexpected Price Slippage**: $P- E [P]$ is the difference between $P$ and
$E [P]$. Unexpected Slippage Rate $\left(\frac{P- E [P]}{ E [P]}\right)$ is
$\quad$ the unexpected slippage over the expected price.

## Appendix

**Expected Execution Price** $(( E [P])$ When a liquidity taker issues a trade
on \(X / Y,\) the taker wishes to execute the trade with the expected execution
price \(E [P]\) (based on the AMM algorithm and \(X / Y\) state), given the
expected slippage.

**Execution Price**: $(P)$ During the time difference between a liquidity taker
issuing a transaction, and the transaction being executed (e.g. mined in a
block), the state of the AMM market \(X / Y\) may change. This state change may
induce unexpected slippage resulting in an execution price \(P \neq E [P]\).

$$
\operatorname{spread}_{\min }=\frac{\cos t_{\min t}(330)}{\text { profit }_{\text {free }}(330)}=\frac{11^{\prime} 993^{\prime} 334}{6^{\prime} 013^{\prime} 004}=1.9946
$$
